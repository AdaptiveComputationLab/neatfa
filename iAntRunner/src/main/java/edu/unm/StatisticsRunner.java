package edu.unm;

import java.io.ByteArrayInputStream;
import java.io.IOException;
import java.io.InputStream;
import java.util.ArrayList;
import java.util.List;
import java.util.Random;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;
import java.util.concurrent.TimeUnit;

/**
 * @author John Ericksen
 */
public class StatisticsRunner {

    private static final Random RAND = new Random();
    private static final String MAX0_CHROMOSOME = "384.0,1,1,17,-2.254641421038617;385.0,1,2,17,0.552560796575301;386.0,1,3,17,-4.712123435770369;387.0,1,4,17,-6.55743699140116;388.0,1,5,17,0.7989453559437973;389.0,1,6,17,1.6505897498540152;390.0,1,7,17,3.7201296932365473;391.0,1,8,17,-2.5466404020809783;392.0,1,9,17,2.117129705989943;393.0,1,10,17,-3.994168428889576;394.0,1,11,17,-5.020735854346505;395.0,1,12,17,-8.151043924540183;396.0,1,13,17,5.0404459826357595;397.0,1,14,17,4.46751633703144;398.0,1,15,17,8.024334239809725;399.0,1,16,17,3.8551782645191928;400.0,1,17,17,-1.7792447209845919;401.0,1,18,17,-1.830573604080784;402.0,1,19,17,9.324185846480926;403.0,1,20,17,4.4172542892403275;405.0,1,22,17,3.4199630941879287;406.0,1,23,17,2.8583955292902683;407.0,1,24,17,1.1448421051655497;408.0,1,1,18,2.24800315037474;409.0,1,2,18,2.149908041094187;410.0,1,3,18,9.499791587338414;411.0,1,4,18,0.4260691189711332;412.0,1,5,18,2.412444448606509;413.0,1,6,18,-1.4512939930725843;414.0,1,7,18,-0.8699708320505556;415.0,1,8,18,-1.7185554817086977;416.0,1,9,18,-1.4419378987407456;417.0,1,10,18,0.8120163282075079;418.0,1,11,18,0.9948417839225177;419.0,1,12,18,-9.165556113369306;420.0,1,13,18,-10.607129581734153;421.0,1,14,18,-3.362607970400406;422.0,1,15,18,4.830846498207704;423.0,1,16,18,2.5927835506133494;424.0,1,17,18,-1.0133033744097775;425.0,1,18,18,4.005608987520597;426.0,1,19,18,4.4489443827435196;427.0,1,20,18,2.127622550748108;429.0,1,22,18,-0.9096306659155863;430.0,1,23,18,-2.2495540184654;431.0,1,24,18,0.23900966045251748;432.0,1,1,19,-6.59509970865666;433.0,1,2,19,1.9907981299374702;434.0,1,3,19,3.0354987632051715;435.0,1,4,19,0.8397246019854582;436.0,1,5,19,0.5594688909771812;437.0,1,6,19,6.846937132246685;438.0,1,7,19,-13.661560083422678;439.0,1,8,19,-8.082134883739993;440.0,1,9,19,3.1632342356032126;441.0,1,10,19,9.349800728967812;442.0,1,11,19,-1.7843535062543103;443.0,1,12,19,-6.174633778117714;444.0,1,13,19,5.402108740606801;445.0,1,14,19,14.028859715475118;446.0,1,15,19,-10.189749656623267;447.0,1,16,19,4.680291371700028;448.0,1,17,19,-3.9431592733958842;449.0,1,18,19,-1.39383415104477;450.0,1,19,19,2.777702114375362;451.0,1,20,19,0.10618773946793883;453.0,1,22,19,-3.7211454769406354;454.0,1,23,19,0.2823925208410741;455.0,1,24,19,0.5935646616649801;456.0,1,1,20,-3.738914243295297;457.0,1,2,20,0.8028822704444751;458.0,1,3,20,1.0046011246754243;459.0,1,4,20,-0.27284849309839937;460.0,1,5,20,-3.818599441906635;461.0,1,6,20,5.7232740032669405;462.0,1,7,20,-3.207405568146993;463.0,1,8,20,1.0801687856145845;464.0,1,9,20,-0.6636711882921551;465.0,1,10,20,-3.1882612863501643;466.0,1,11,20,5.176748494779669;467.0,1,12,20,4.932500374577131;468.0,1,13,20,-0.10013821633543996;469.0,1,14,20,1.8799711424745864;470.0,1,15,20,-4.927480600216588;471.0,1,16,20,-0.27176469373038975;472.0,1,17,20,-5.961238993366786;473.0,1,18,20,-1.0280367733737568;474.0,1,19,20,9.831656279351675;475.0,1,20,20,-9.769672343897785;477.0,1,22,20,-0.7627488353269465;478.0,1,23,20,-11.015288233646835;479.0,1,24,20,-3.371615137338475;504.0,1,1,22,1.1217353842051616;505.0,1,2,22,-4.961160275194003;506.0,1,3,22,4.975032420455834;507.0,1,4,22,-1.161869964607066;508.0,1,5,22,-1.8328502337132786;509.0,1,6,22,-1.2660941225120763;510.0,1,7,22,-2.85284033675209;511.0,1,8,22,-1.1154583484272076;512.0,1,9,22,-0.4388108815996178;513.0,1,10,22,-2.625213347883785;514.0,1,11,22,5.1168753454651705;515.0,1,12,22,13.805240536815663;516.0,1,13,22,10.015946620596555;517.0,1,14,22,-2.2389311744966;518.0,1,15,22,4.08964368525004;519.0,1,16,22,1.9817145463214882;520.0,1,17,22,0.024898503955701812;521.0,1,18,22,0.4692069228346151;522.0,1,19,22,-4.0667603140945285;523.0,0,20,22,2.8170637367823135;525.0,1,22,22,-0.48229382476618887;526.0,1,23,22,-4.496658867115368;527.0,1,24,22,0.044033590562547464;528.0,1,1,23,1.4974822064910551;529.0,1,2,23,2.0844079481934106;530.0,1,3,23,5.473213543408232;531.0,1,4,23,2.6599173541237104;532.0,1,5,23,4.798215928957692;533.0,1,6,23,-3.194079758371071;534.0,1,7,23,1.2265105919082444;535.0,1,8,23,7.964877255334658;536.0,1,9,23,0.736452037923514;537.0,1,10,23,11.84992504738866;538.0,1,11,23,5.990210656417699;539.0,1,12,23,1.9023467591008183;540.0,1,13,23,-1.1188403229380834;541.0,1,14,23,3.69439690250744;542.0,1,15,23,-0.8973306702323393;543.0,1,16,23,0.5178091148066607;544.0,1,17,23,5.377784876280841;545.0,1,18,23,-0.8828539869793433;546.0,1,19,23,-0.9091372306505614;547.0,1,20,23,4.808540550480378;549.0,1,22,23,0.49200307073048427;550.0,1,23,23,-12.905277477514016;551.0,1,24,23,3.7320494932376707;552.0,1,1,24,-2.966901743043641;553.0,1,2,24,-4.447204770989657;554.0,1,3,24,3.64530881479636;555.0,1,4,24,-7.651341318276859;556.0,1,5,24,-3.176409717306087;557.0,1,6,24,-12.888859402355084;558.0,1,7,24,-1.1395555236544839;559.0,1,8,24,-4.652202382555193;560.0,1,9,24,0.874273678367063;561.0,1,10,24,4.143643083943663;562.0,1,11,24,5.823166257135149;563.0,1,12,24,17.06349540951775;564.0,1,13,24,-9.897615844488058;565.0,1,14,24,-5.602509213141261;566.0,1,15,24,0.012331608156104068;567.0,1,16,24,0.5705251181000677;568.0,1,17,24,0.7366113567778781;569.0,1,18,24,-0.6748653239809637;570.0,1,19,24,4.38826134933282;571.0,1,20,24,-3.145831889540679;573.0,1,22,24,3.890669433250597;574.0,1,23,24,-2.753189220569829;575.0,1,24,24,-2.793920267603709;620.0,1,19,44,2.440161604895213;621.0,1,44,24,3.311442133995815;628.0,1,7,46,-1.2717535335221724;629.0,1,46,19,2.5212405746403177;636.0,1,12,44,6.177342399667292;646.0,1,9,46,0.6329643111638148;692.0,1,6,44,-1.5844550306472585;725.0,1,46,20,-3.7691486094743443;787.0,1,44,22,4.118725993780442;856.0,1,8,44,-2.4159897163664192;891.0,1,46,24,0.8285214386292067;950.0,1,46,23,-2.7478242731542393;964.0,1,3,46,-1.438932223354857;972.0,1,17,46,3.294723758047039;1000.0,1,8,46,-0.5389159000782346;1071.0,1,2,44,1.0184063097892389;1122.0,1,17,44,-2.033459877034504;1139.0,1,14,46,2.421808930939748;1238.0,1,1,44,-5.958462513228801;1264.0,1,46,194,0.8604078503348186;1265.0,1,194,23,2.719004709757873;1396.0,1,194,19,4.951254662753318;1415.0,1,11,46,-3.0701849229990668;1424.0,1,194,44,2.6623199865642477;1447.0,1,7,237,1.6336989258489203;1448.0,1,237,18,-2.87548474699274;1519.0,1,46,248,1.0402790406544273;1520.0,1,248,194,1.2104516499304334;1551.0,1,11,194,-1.4147504239236963;1694.0,1,1,46,0.2612352558783752;1769.0,1,248,22,-2.785199729308591;1799.0,1,9,237,4.941082051793796;1820.0,1,9,44,-2.3848221110736407;1855.0,1,3,237,0.7202213490859931;1897.0,1,194,20,-5.53839252868867;1925.0,1,13,44,3.7675916056444727;2105.0,1,12,237,-0.4740633448956948;2118.0,1,2,248,-2.2826992549597738;2131.0,1,46,18,5.311549871639415;2147.0,1,3,194,1.8265755949961862;2164.0,1,2,388,2.038890822437972;2165.0,1,388,22,-0.4376363615706429;2179.0,1,3,392,-1.6360585303285224;2180.0,1,392,22,0.2320631688270916;2191.0,1,4,396,-3.260925352441445;2192.0,1,396,20,-8.3661385447068;2203.0,1,4,44,-0.024866798387916556;2213.0,1,14,248,-3.2812632071705736;2363.0,1,10,194,1.495584140368622;2424.0,1,2,457,1.644423951342104;2425.0,1,457,388,-0.12398338677672757;2434.0,0,5,237,-3.2753276239311115;2514.0,1,396,18,0.2813619334324765;2538.0,1,46,44,0.5180812164254153;2548.0,1,1,396,0.6452090125369514;2562.0,1,1,487,-1.6861045035536926;2563.0,1,487,20,-4.514578374888482;2574.0,1,3,487,-4.803679313287398;2642.0,1,12,487,-2.3191917200271472;2673.0,1,457,24,3.7900719998087258;2700.0,1,10,511,1.0;2701.0,1,511,19,8.421651952082254;2740.0,1,194,487,-6.253366759574826;2762.0,1,7,392,7.463905533834724;2774.0,1,8,392,-3.5951699898321694;2790.0,1,17,528,1.0;2791.0,1,528,46,2.719416514213493;2799.0,1,396,388,-6.517375441281309;2814.0,1,11,534,0.4883718749263145;2815.0,1,534,24,4.601525714670055;2927.0,1,44,23,2.921054215153341;2950.0,1,20,560,1.0;2951.0,1,560,22,2.8170637367823135;2985.0,1,16,534,0.8942779407211598;3003.0,1,15,46,-8.462544996989974;3008.0,1,2,487,0.7798109094787697;3045.0,1,46,457,7.378721069045021;3058.0,1,5,581,1.0;3059.0,1,581,237,-3.2753276239311115;3102.0,1,15,194,-5.9036290497808475;3126.0,1,7,599,1.0;3127.0,1,599,46,-1.2717535335221724;";
    private static final String MAX1_CHROMOSOME = "384.0,1,1,17,8.028600474772752;385.0,1,2,17,0.8803870389563675;386.0,1,3,17,-2.847182328382662;387.0,1,4,17,9.187550930544715;388.0,1,5,17,-0.7861335932469891;389.0,1,6,17,-3.845972840983915;390.0,1,7,17,1.0143735282046085;391.0,1,8,17,-2.848536358344877;392.0,1,9,17,-1.6278644686202552;393.0,1,10,17,-3.1509220969430074;394.0,1,11,17,-3.6433257127958893;395.0,1,12,17,-0.892751900967681;396.0,0,13,17,1.62847060767653;397.0,1,14,17,-2.4771641320572724;398.0,1,15,17,-3.371033036313692;399.0,1,16,17,-0.029057283541604084;400.0,1,17,17,-1.5113529219364361;401.0,1,18,17,-2.675679211904481;402.0,1,19,17,-0.4241598427245809;403.0,1,20,17,3.6019682306584437;405.0,1,22,17,-2.7308205210687726;406.0,1,23,17,0.9937029639040289;407.0,1,24,17,-1.5798619029517047;408.0,1,1,18,-4.784947531952087;409.0,1,2,18,0.25293883984558807;410.0,1,3,18,-3.220047387396313;411.0,1,4,18,-1.0705116134520822;412.0,1,5,18,-0.9618625282745018;413.0,1,6,18,-15.030141671337812;414.0,1,7,18,-5.035194832503831;415.0,1,8,18,-3.970275325520677;416.0,1,9,18,2.8095388332449813;417.0,1,10,18,0.06364949226564076;418.0,1,11,18,-0.5552684135074255;419.0,1,12,18,17.191536608345473;420.0,1,13,18,6.641562655076282;421.0,1,14,18,11.593775122782054;422.0,1,15,18,-21.975698342004954;423.0,1,16,18,-16.454889921767904;424.0,1,17,18,-0.2559618869252538;425.0,1,18,18,-2.2024686147233368;426.0,1,19,18,-0.9687220289862656;427.0,1,20,18,0.46739258855595633;429.0,1,22,18,-2.748036115825159;430.0,1,23,18,0.33842058010221776;431.0,1,24,18,-0.5083931454448166;432.0,1,1,19,4.100305209884496;433.0,1,2,19,-3.429354345433045;434.0,1,3,19,6.488768457385026;435.0,1,4,19,-0.2371962369503999;436.0,1,5,19,0.3648188724726321;437.0,1,6,19,-1.2680778503749144;438.0,1,7,19,-5.301757500827166;439.0,1,8,19,2.171978694330618;440.0,1,9,19,-11.845524787216238;441.0,1,10,19,0.8601054618448417;442.0,1,11,19,2.306657105591244;443.0,1,12,19,8.834481037608164;444.0,1,13,19,-2.873774829565749;445.0,1,14,19,4.135129757544961;446.0,1,15,19,0.6911184343133867;447.0,1,16,19,1.8973294315198381;448.0,1,17,19,-2.3834760480458375;449.0,1,18,19,5.356892389157319;450.0,1,19,19,26.609623801878488;451.0,1,20,19,4.855181934326963;453.0,1,22,19,-4.132200399687672;454.0,1,23,19,-3.7434587605589003;455.0,1,24,19,-7.600116347983508;456.0,1,1,20,1.5469351927824757;457.0,1,2,20,6.4912459737621635;458.0,1,3,20,-2.111434189745451;459.0,1,4,20,1.4254130040891932;460.0,1,5,20,1.583424978335668;461.0,1,6,20,-3.7361739944859886;462.0,1,7,20,2.3054105267429805;463.0,1,8,20,9.40026927808799;464.0,1,9,20,-5.398740110447147;465.0,1,10,20,1.6467863296957725;466.0,1,11,20,-0.7045866883611516;467.0,1,12,20,21.464972592184502;468.0,1,13,20,11.01307166352585;469.0,1,14,20,-3.455494904582583;470.0,1,15,20,-6.704510766764235;471.0,1,16,20,3.3634383325969974;472.0,1,17,20,-9.249394790869871;473.0,1,18,20,-10.496973057662874;474.0,1,19,20,-1.0599170327076635;475.0,1,20,20,0.8805105527356265;477.0,1,22,20,0.49874364075204697;478.0,1,23,20,-10.484365005415968;479.0,1,24,20,-2.3527800654963276;504.0,1,1,22,5.277068692459183;505.0,1,2,22,-0.8224092450602266;506.0,1,3,22,7.828798445662603;507.0,1,4,22,2.183702251355297;508.0,1,5,22,3.505472430053624;509.0,1,6,22,-0.4430874772598863;510.0,1,7,22,-5.6556993340715715;511.0,1,8,22,-0.7315004670520476;512.0,1,9,22,3.6820679186236496;513.0,1,10,22,-2.8460708101047945;514.0,1,11,22,-5.89759461578781;515.0,1,12,22,-3.316779245411346;516.0,1,13,22,-0.7246452223179813;517.0,1,14,22,-2.5859142900678282;518.0,1,15,22,8.447188960476156;519.0,1,16,22,3.240599868946243;520.0,1,17,22,-2.4517445430687768;521.0,1,18,22,5.199740186132561;522.0,1,19,22,2.106077271749418;523.0,1,20,22,0.816451321028736;525.0,1,22,22,-5.422469078565134;526.0,1,23,22,3.7986686681008486;527.0,1,24,22,-3.5181420655984543;528.0,1,1,23,5.922705254610397;529.0,1,2,23,-0.5340173282555852;530.0,1,3,23,-2.1796801074932795;531.0,1,4,23,-4.97416784497733;532.0,1,5,23,4.88072424967093;533.0,1,6,23,1.6529736459185378;534.0,1,7,23,-3.6129979006189283;535.0,1,8,23,1.8696720906332742;536.0,1,9,23,-4.182838718776413;537.0,1,10,23,-2.3584639716301297;538.0,1,11,23,8.420997370400357;539.0,1,12,23,-2.465775008748386;540.0,1,13,23,0.9359202099746231;541.0,1,14,23,-10.875172437261451;542.0,1,15,23,5.923157669624139;543.0,1,16,23,-0.1462174169201548;544.0,1,17,23,4.266332974094199;545.0,1,18,23,-8.326476073382448;546.0,1,19,23,-10.733336944247425;547.0,1,20,23,-0.12132560125738234;549.0,0,22,23,1.473104615937452;550.0,1,23,23,1.0290503801492523;551.0,1,24,23,-4.512937588113434;552.0,1,1,24,2.3599343187674364;553.0,1,2,24,-2.287336914853928;554.0,1,3,24,-16.77368195618871;555.0,1,4,24,3.3013367088027987;556.0,1,5,24,4.115408308344422;557.0,1,6,24,-7.877750577852021;558.0,1,7,24,-3.2233395773590674;559.0,1,8,24,3.023170384445602;560.0,1,9,24,-2.9757846503535728;561.0,1,10,24,4.539466341246331;562.0,1,11,24,-0.5228338289908165;563.0,1,12,24,0.7461117089554155;564.0,1,13,24,0.6238749064632438;565.0,1,14,24,1.4409382001816922;566.0,1,15,24,-0.2876363985213408;567.0,1,16,24,4.718730506128457;568.0,1,17,24,-3.317908884578273;569.0,1,18,24,0.9072807333232427;570.0,1,19,24,-10.95472899552938;571.0,1,20,24,-7.553375039428954;573.0,1,22,24,-15.383697131566654;574.0,1,23,24,1.6172374157262757;575.0,1,24,24,-5.118584249534485;595.0,1,11,34,-1.7676744790918804;596.0,1,34,19,-1.6565329400059636;604.0,1,1,34,-0.2737257387536206;648.0,1,12,34,1.846057237968012;687.0,1,17,34,-2.4590111533505827;705.0,1,4,34,-11.609824716132044;714.0,1,18,34,1.5153501843367791;729.0,1,5,34,4.319092024950006;754.0,1,2,34,-0.4515667769628928;821.0,1,2,93,2.4783955780956806;822.0,1,93,24,-8.574485177406041;909.0,1,24,114,-6.359406987356758;910.0,1,114,23,-5.398238435569436;934.0,1,14,114,13.400646157481695;988.0,1,16,93,10.412240116708908;1055.0,1,23,145,3.654648471073288;1056.0,1,145,24,4.789017033073346;1131.0,0,145,93,-2.331355729643694;1191.0,1,11,181,10.09575430918094;1192.0,1,181,20,1.5793042017499668;1311.0,1,5,209,-10.74169508604704;1312.0,1,209,34,-4.1619305840673535;1474.0,1,14,245,4.146131199293555;1475.0,1,245,114,4.98572084861158;1495.0,1,7,114,-3.474605419480166;1509.0,1,245,34,-3.7539965066127228;1595.0,1,245,209,1.921625242914235;1647.0,1,14,34,-4.500100777947498;1716.0,1,8,301,-0.34458417230219945;1717.0,1,301,20,9.398487328253864;1737.0,1,6,305,9.806792872632201;1738.0,1,305,22,0.4358179345163007;1759.0,1,19,308,1.5908169229872584;1760.0,1,308,23,-2.538999580963323;1783.0,1,16,34,4.881426664364609;1863.0,1,11,209,1.8901280495799544;1894.0,1,14,343,0.1957371485941406;1895.0,1,343,24,-12.474888445193667;1901.0,1,14,345,-3.7986337700984745;1902.0,1,345,343,0.18133629238873317;1927.0,1,10,209,-3.082394234147398;1937.0,1,4,145,-2.459219536803534;2064.0,1,14,378,1.514111776932317;2065.0,1,378,343,2.8438176257846264;2225.0,1,181,24,-2.4938613767060933;2243.0,1,13,421,4.564180384613456;2244.0,1,421,18,7.136228343175784;2305.0,1,308,93,-0.5573042899163305;2394.0,1,10,343,-1.9738051928901204;2412.0,1,181,463,3.664376391820804;2413.0,1,463,24,-3.108482872037288;2419.0,1,15,421,0.5339462955167048;2447.0,1,13,471,-0.09910019074805532;2448.0,1,471,19,0.8803336784597094;2459.0,1,17,475,-6.046634252054017;2460.0,1,475,22,0.096349716422519;2480.0,1,181,19,-3.585575087751611;2489.0,1,13,181,-0.6319861899256232;2561.0,0,23,343,-0.8818003587505567;2590.0,1,114,20,-2.6610323478878968;2599.0,1,11,501,0.24255554377619182;2600.0,1,501,24,-0.46555252372314426;2614.0,1,378,145,-2.480855682953371;2665.0,1,5,305,-1.310459876392149;2790.0,1,1,542,1.3395625724937517;2791.0,1,542,22,0.09361447532752032;2887.0,1,471,181,0.4092105571016007;2900.0,1,7,181,-2.787761363904371;2968.0,1,11,378,-1.4428803536026087;2985.0,1,181,345,-1.3754569152422635;3010.0,1,345,475,1.0252668694402365;3086.0,1,8,601,-0.8944403630902111;3087.0,1,601,18,4.713651805085513;3091.0,1,114,463,-0.914503630255654;3155.0,1,8,34,-0.2651224652069242;3170.0,1,1,616,4.832035946740513;3171.0,1,616,20,1.9625071345311236;3191.0,1,18,378,-1.1973072704676535;3335.0,1,13,601,1.5370163880069265;3361.0,1,9,660,2.574490275274325;3362.0,1,660,18,-0.40201767069378413;3402.0,1,11,671,1.6033752623132491;3403.0,1,671,20,-0.07113985221272401;3444.0,1,3,542,0.6987586326600643;3482.0,1,20,698,-0.3922113370499515;3483.0,1,698,18,-0.6148257065517702;3494.0,1,181,475,1.8225943587957478;3513.0,1,4,308,1.1408636710406463;3638.0,1,13,731,0.5310280369574363;3639.0,1,731,19,0.8446643527926275;3664.0,1,181,301,-4.826662545303729;3717.0,1,9,463,-2.088645218365;3736.0,1,181,114,-1.3497577178078688;3745.0,1,671,308,-3.3400937124685157;3835.0,1,19,775,1.92450476203772;3836.0,1,775,17,0.6039411480764656;3850.0,1,475,501,-0.5526037422498263;3870.0,1,660,93,7.152223368449824;3887.0,1,23,779,-0.6183349645016636;3888.0,1,779,343,-5.338156706413843;3955.0,1,145,793,1.0;3956.0,1,793,93,-0.6900350618645079;3962.0,1,209,501,5.621604528138184;3979.0,1,22,797,1.0;3980.0,1,797,23,1.473104615937452;4000.0,1,660,34,-5.642398177909969;4004.0,1,20,463,-2.229720045334801;4018.0,1,181,698,2.448146332607962;4032.0,1,13,810,1.0;4033.0,0,810,17,1.62847060767653;4049.0,1,13,616,-8.950936609922993;4061.0,1,810,815,1.0;4062.0,1,815,17,1.62847060767653;";
    private static final String MAX2_CHROMOSOME = "384.0,1,1,17,-1.5601071303445617;385.0,1,2,17,2.59205524239083;386.0,1,3,17,4.415745683757838;387.0,1,4,17,-1.5250193791825841;388.0,1,5,17,1.9088604796418847;389.0,1,6,17,14.57757321760522;390.0,1,7,17,3.1675975190785155;391.0,1,8,17,-1.1465203804283957;392.0,1,9,17,-8.261697310246959;393.0,1,10,17,2.7063950590025745;394.0,1,11,17,-3.1304160005282515;395.0,1,12,17,-1.5021954238197925;396.0,1,13,17,0.14732991948297414;397.0,1,14,17,-2.669555034333055;398.0,1,15,17,-3.396226475693126;399.0,1,16,17,-13.347060688398232;400.0,1,17,17,-12.217018204588843;401.0,1,18,17,-5.489018022962014;402.0,1,19,17,5.8260878212369835;403.0,1,20,17,-1.1365459399152225;405.0,1,22,17,5.858386001307255;406.0,1,23,17,-11.607921933346708;407.0,1,24,17,0.43154495043401114;408.0,1,1,18,1.246484565963086;409.0,1,2,18,-0.6296094659543969;410.0,1,3,18,-3.9319496528662046;411.0,1,4,18,-4.997507806105776;412.0,1,5,18,-1.603763797543327;413.0,1,6,18,22.622229211573526;414.0,1,7,18,-6.303102168005178;415.0,1,8,18,-8.808934583421491;416.0,1,9,18,-5.995469340438794;417.0,1,10,18,7.56770009959611;418.0,1,11,18,5.278941201990631;419.0,1,12,18,-26.77435918072439;420.0,1,13,18,21.02605706794256;421.0,1,14,18,3.3838958566488317;422.0,1,15,18,-2.447035232472501;423.0,1,16,18,-18.700108696789826;424.0,1,17,18,0.7285038060375262;425.0,1,18,18,-6.314303157872001;426.0,1,19,18,4.883757069977669;427.0,1,20,18,1.9228081005711595;429.0,1,22,18,-7.531464112583295;430.0,1,23,18,2.6164965580901183;431.0,1,24,18,0.34135410449215975;432.0,1,1,19,1.2282819547887067;433.0,1,2,19,-5.7256308840479075;434.0,1,3,19,2.536570453809695;435.0,1,4,19,1.7719682131738677;436.0,1,5,19,1.4855750675983714;437.0,1,6,19,3.7718157560460446;438.0,1,7,19,-0.9132076298345615;439.0,1,8,19,9.596907015606762;440.0,1,9,19,-0.7158011783825446;441.0,1,10,19,-2.6841720288063113;442.0,1,11,19,-0.4446696438880202;443.0,1,12,19,-22.290917400189567;444.0,1,13,19,-11.372578977051466;445.0,1,14,19,-0.5691996273405674;446.0,1,15,19,-0.32945514761770145;447.0,1,16,19,-3.1686377991383803;448.0,1,17,19,4.930033750028928;449.0,1,18,19,-0.1922045159760653;450.0,1,19,19,7.979561382958828;451.0,1,20,19,-2.0580447686016106;453.0,1,22,19,-10.922827891133476;454.0,1,23,19,9.134627255720416;455.0,1,24,19,2.1901642390153415;456.0,1,1,20,1.9778278229491026;457.0,1,2,20,0.3275523035735417;458.0,1,3,20,-4.303317470529545;459.0,1,4,20,-15.926050520116537;460.0,1,5,20,8.515333724435362;461.0,1,6,20,5.472352303605213;462.0,1,7,20,-13.749017923584415;463.0,1,8,20,0.007938470169496004;464.0,1,9,20,4.881304066729827;465.0,1,10,20,3.937544029797594;466.0,1,11,20,8.808597747830563;467.0,1,12,20,1.6799916134351744;468.0,1,13,20,-2.599462307020981;469.0,1,14,20,-0.5711583139613994;470.0,1,15,20,0.1270576455571093;471.0,1,16,20,-1.0131287328253538;472.0,1,17,20,4.922506832754975;473.0,1,18,20,2.3874822349748492;474.0,1,19,20,-12.13559479396946;475.0,1,20,20,-4.8344401174528535;477.0,1,22,20,6.355102365435763;478.0,1,23,20,8.678833669697722;479.0,1,24,20,-5.208317371838069;504.0,1,1,22,6.8478828201892235;505.0,1,2,22,-3.0089802983414478;506.0,1,3,22,-6.187698040124477;507.0,1,4,22,2.1677284985927856;508.0,1,5,22,-0.10724719091378809;509.0,1,6,22,-9.480941802818187;510.0,1,7,22,-4.087653852970692;511.0,1,8,22,3.785901848924509;512.0,1,9,22,4.812751648594959;513.0,1,10,22,17.232976759954994;514.0,1,11,22,0.06379540010931328;515.0,1,12,22,5.329606753633168;516.0,1,13,22,-1.553567621342824;517.0,1,14,22,-10.894876588492846;518.0,1,15,22,-7.485318223397618;519.0,1,16,22,3.0117899501779974;520.0,1,17,22,14.125541995199885;521.0,1,18,22,-3.2431172389766685;522.0,1,19,22,0.5754507248799767;523.0,1,20,22,-11.99956089965792;525.0,1,22,22,-14.7637193376869;526.0,1,23,22,6.011597399951869;527.0,1,24,22,7.426336967031224;528.0,1,1,23,0.8025045987264212;529.0,1,2,23,5.147343618380583;530.0,1,3,23,-12.925307524280257;531.0,1,4,23,-1.207164967681042;532.0,1,5,23,0.0885129129603126;533.0,1,6,23,-6.904761420727107;534.0,1,7,23,3.76562408050498;535.0,1,8,23,0.12567807853087576;536.0,1,9,23,4.457672738805531;537.0,1,10,23,-24.548996237434185;538.0,1,11,23,15.13312841459687;539.0,1,12,23,1.055045713263521;540.0,1,13,23,4.668459894196594;541.0,1,14,23,-4.533797066748146;542.0,1,15,23,-5.886260852213871;543.0,1,16,23,0.23891249868755393;544.0,1,17,23,-7.705624138429187;545.0,1,18,23,5.472177320287566;546.0,1,19,23,-3.2073799240025176;547.0,1,20,23,0.8861006660371209;549.0,1,22,23,7.907630402922411;550.0,1,23,23,-2.3749937392254115;551.0,1,24,23,-0.14933668666907451;552.0,1,1,24,-5.6527961168183065;553.0,1,2,24,-2.9707414499423104;554.0,1,3,24,-7.225208942016317;555.0,1,4,24,1.7868492436409609;556.0,1,5,24,-5.922106748488277;557.0,1,6,24,3.2879071979422574;558.0,1,7,24,8.561555501889067;559.0,1,8,24,12.569226414103001;560.0,1,9,24,-13.395293122854135;561.0,1,10,24,9.652788368450306;562.0,1,11,24,-2.502974402472154;563.0,1,12,24,-23.233288014503405;564.0,1,13,24,16.165175002192736;565.0,1,14,24,5.0428130196066805;566.0,1,15,24,0.9333440671535439;567.0,1,16,24,-3.675584320357034;568.0,1,17,24,6.551052179540637;569.0,1,18,24,2.5890571176241766;570.0,1,19,24,-1.4426653365705582;571.0,1,20,24,12.02777702348299;573.0,1,22,24,0.21634034259094825;574.0,1,23,24,-6.781839076073919;575.0,1,24,24,5.963089248255773;805.0,1,1,97,-0.36274828517278324;806.0,1,97,18,-21.32749004105444;815.0,1,8,97,-6.290842163237082;895.0,1,18,118,-2.6721755807315817;896.0,1,118,18,-1.0523898786945518;911.0,1,3,97,-10.537332661652048;930.0,1,11,128,-3.062053127057028;931.0,1,128,20,-2.084997155923449;953.0,1,11,97,-13.009379039651995;979.0,1,14,118,-4.365682517174396;1004.0,1,17,97,-0.6768435032560007;1041.0,1,10,118,4.1445631868277415;1087.0,1,16,97,14.141435179789573;1090.0,1,3,128,0.14311920844094989;1119.0,1,6,172,8.631526374487308;1120.0,1,172,19,4.580959179430296;1169.0,1,118,128,-5.294912347860155;1196.0,1,3,187,1.6958616948467111;1197.0,1,187,128,9.333137697957675;1252.0,1,8,202,-0.2472124776064113;1253.0,1,202,17,-3.7682255625956156;1489.0,1,10,257,4.063438401197603;1490.0,1,257,23,-0.6833498851694939;1526.0,1,257,22,-1.4803639417293928;1534.0,1,4,266,-4.45716188387926;1535.0,1,266,20,-5.79416906448491;1593.0,1,16,187,0.8209376676069162;1682.0,1,2,303,1.9165266188157717;1683.0,1,303,24,0.22189271651882492;1758.0,1,17,322,0.48053903530561937;1759.0,1,322,20,-1.4848184372766675;1844.0,1,7,97,0.18170926247508315;1892.0,1,187,23,1.4329480968276533;1947.0,1,15,257,1.985405501078935;1958.0,1,14,257,0.5005549619682875;1966.0,1,12,172,0.7613314618043288;2017.0,1,2,376,0.6232550213091147;2018.0,1,376,18,1.3608006544119484;2037.0,1,10,322,0.3030274165210445;2064.0,1,1,128,-1.5032572718319233;2076.0,1,11,266,-1.3376115165566795;2096.0,1,6,376,2.5298370188622106;2161.0,1,13,172,1.01188298805934;2231.0,1,18,419,-0.5425590832030649;2232.0,1,419,24,-3.180056086917622;2242.0,1,257,322,3.5188643637449446;2260.0,1,266,18,0.5211176495158049;2380.0,1,22,447,-1.443663568421565;2381.0,1,447,20,1.6455371838410673;2446.0,1,419,20,1.802713673461308;2467.0,1,3,376,-4.28986545347402;2480.0,1,17,257,1.2435869625752538;2641.0,1,10,507,0.13561757750721723;2642.0,1,507,24,-1.1489105915372366;2658.0,1,16,172,1.2729938052412417;2711.0,1,17,522,-0.9627678502604526;2712.0,1,522,22,-1.3757934045823883;2727.0,1,376,172,0.8188254910342321;2769.0,1,7,172,5.972435656488881;2827.0,1,15,507,-1.4979106378413576;2831.0,1,18,447,-0.8446251349998981;2846.0,1,11,551,0.15933214165886467;2847.0,1,551,23,-0.4011331414548207;2857.0,1,18,522,1.026592387850148;2900.0,1,172,551,1.15734003940495;2928.0,1,118,376,0.5835546903194719;2938.0,1,15,564,-2.2441271943712504;2939.0,1,564,507,-0.3805196912079445;3041.0,1,8,322,-6.196571342777095;3108.0,1,9,322,2.493637239113112;3278.0,1,2,522,-3.1164534570958002;3538.0,1,19,187,-1.6650147606260193;3614.0,1,97,564,1.495794807138883;3662.0,1,13,507,1.4267503446312615;3739.0,1,97,376,-2.462690705253288;3775.0,1,2,752,1.0;3776.0,1,752,303,-2.081252519125925;";
    private static final String[] CHROMOSOMES = {MAX0_CHROMOSOME, MAX1_CHROMOSOME, MAX2_CHROMOSOME};
    private static final String HOME_DIRECTORY = "/home/john/dev/iAnt-ARGoS/";
    private static final String EXECUTABLE = "./build/source/iant_main";

    public static void main(String[] args) throws Exception {
        new StatisticsRunner().run();
    }

    public void run() throws Exception  {
        IAntXMLBuilder builder = new IAntXMLBuilder();

        AutoValue_ExperimentParameters.Builder parametersBuilder = new AutoValue_ExperimentParameters.Builder();

        parametersBuilder
                .populationSize(100)
                .runtime(30 * 60)
                .entityCount(6);

        for(int i = 0; i < 3; i++) {
            long startTime = System.currentTimeMillis();
            String chromosome = CHROMOSOMES[i];

            for(int d = 0; d < 3; d++) {

                parametersBuilder
                        .distribution(d)
                        .startTime(System.currentTimeMillis());


                final List<Long> fitness = new ArrayList<Long>();
                ExecutorService executor = Executors.newFixedThreadPool(Runtime.getRuntime().availableProcessors());

                for(int j = 0; j < 40; j++) {

                    InputStream xml = new ByteArrayInputStream(builder.buildXML(chromosome, RAND.nextInt(65536), parametersBuilder.build()).getBytes());

                    final String tag = startTime + "F" + i + "D" + d + "C" + j;

                    executor.submit(
                            new ProcessExecutable(HOME_DIRECTORY, new String[]{EXECUTABLE, tag}, xml,
                                    new ProcessExecutable.OnResultCallback() {
                                        @Override
                                        public void onResult(Long result) {
                                            //System.out.println("Tag: " + tag + " Fitness: " + result);
                                            fitness.add(result);
                                        }
                                    }
                            ));
                }

                executor.shutdown();

                while (!executor.awaitTermination(1, TimeUnit.SECONDS)) {}
                System.out.println("For: " + i + " Dist: " + d + " Stats: " + getStatistics(fitness));
            }

        }
    }

    private String getStatistics(List<Long> fitness) {
        long sum = 0;

        for(Long f : fitness) {
            sum += f;
        }

        double average = sum / fitness.size();

        double stddevsum = 0;
        for(Long f : fitness) {
            stddevsum += Math.pow((f - average), 2);
        }

        double stddev = Math.sqrt(stddevsum / fitness.size());

        return "Average: " + average + " Std Dev: " + stddev;
    }
}
